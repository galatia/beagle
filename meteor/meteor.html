<head>
  <title>BEAGLE</title>
  <link rel="stylesheet" href="/font-awesome-4.3.0/css/font-awesome.min.css">
</head>

<body>
  {{> loginButtons}}
</body>

<template name="sidebar">
  <div class="sidebar">
    <div class="toolbar">
      <div class="sortMenu">
        <i class="fa fa-sort-amount-desc"></i>
        <div class="options">
          <div class="option" data-sortOrder="newThreads">New threads</div>
          <div class="option" data-sortOrder="recentActivity">Recent activity</div>
          <div class="option" data-sortOrder="pageOrdered">Page-ordered</div>
        </div>
      </div>
    </div>
    <p>The source URL is: {{sourceUrl}}</p>
    <!-- <p>Its creator is: {{creator}}</p> -->
    <p><button class="screenshot-taker">Take a screenshot</button></p>
    {{#each highlights}}
      {{> highlight}}
    {{/each}}
  </div>
  {{#with linkPreview}}
    {{> linkPreviewer}}
  {{/with}}
  {{#with linkEdit}}
    {{> linkEditor}}
  {{/with}}
</template>

<template name="highlight">
  <div class="highlight {{#if hovered}}hovered{{/if}} {{#if clicked}}clicked{{/if}}" id="{{_id}}">
    <div class="sourceText" contenteditable></div>
    {{#each annotations}}
      {{> annotation}}
    {{/each}}
  </div>
</template>

<template name="annotation">
  <div class="annotation">
    {{#if compose}}
      {{> composeBox}}
    {{else}}
      {{> singleAnnotation}}
    {{/if}}
    {{#if annotations}}
      <div class="replies">
        {{#each annotations}}
          {{> annotation}}
        {{/each}}
      </div>
    {{/if}}
  </div>
</template>

<template name="singleAnnotation">
  <div class="singleAnnotation">
    <div class="authorBlock">
      <img src="{{author.picture}}"/>
      <span class="author">{{author.name}}</span>
      <time datetime={{toISOString createdAt}} title={{localISO createdAt}}>{{fromNow createdAt}}</time>
      <div class="actionBar">
        {{#if owner}}
          <span class="edit action"><i class="fa fa-pencil"></i></span>
        {{/if}}
        <span class="reply action"><i class="fa fa-reply"></i></span>
      </div>
    </div>
    <div class="contentContainer">
      <div class="content">{{{content}}}</div>
    </div>
  </div>
</template>

<template name="composeBox">
  <form class="composeBox">

    <div class="toolbar">
      <span class="action" data-command="bold"><i class="fa fa-bold"></i></span>
      <span class="action" data-command="italic"><i class="fa fa-italic"></i></span>
      <span class="action" data-command="underline"><i class="fa fa-underline"></i></span>
      <span class="action" data-command="strikeThrough"><i class="fa fa-strikethrough"></i></span>
      <span class="action" data-command="insertUnorderedList"><i class="fa fa-list-ul"></i></span>
      <span class="action" data-command="insertOrderedList"><i class="fa fa-list-ol"></i></span>
      <span class="action" data-command="indent"><i class="fa fa-indent"></i></span>
      <span class="action" data-command="outdent"><i class="fa fa-outdent"></i></span>
      <span class="removeFormat action"><i>T</i><sub><small>X</small></sub></span>
      <span class="createLink action"><i class="fa fa-link"></i></span>
    </div>

    <div class="composeFieldContainer">
      <div contenteditable class="composeField" tabindex=1></div>
    </div>

    <div class="actionList">
      <span class="save action" tabindex=2><i class="fa fa-check"></i></span>
      <span class="discard action" tabindex=3><i class="fa fa-times"></i></span>
      {{#if editing.content}}
        <span class="delete action"><i class="fa fa-trash-o"></i></span>
      {{/if}}
    </div>

  </form>
</template>

<template name="linkPreviewer">
  <div class="linkPreviewContainer" style="top: {{y}}px">
    <div id="linkPreviewer">
      <a class="change" href="#">Change</a>
      <a class="remove" href="#">Remove</a>
      <span class="gotoLink"><span class="goto">Go to:</span> <a target="_blank" href="{{href}}">{{href}}</a></span>
    </div>
  </div>
</template>

<template name="linkEditor">
  <div class="linkEditContainer" style="top: {{y}}px">
    <div id="linkEditor">
      <form>
        <div>
          <label for="displayText">Text:</label>
          <input name="displayText" type="text" value="{{text}}" required tabindex=1>
        </div>
        <div>
          <label for="href">Link to:</label>
          <input name="href" type="text" value="{{href}}" required pattern="(mailto:)?^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?)*|(https?://)?[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?)+(\/.*)?" tabindex=2>
        </div>
      </form>
      <div>
        <button class="discard" formnovalidate tabindex=4>Discard</button>
        <button class="done" tabindex=3>Done</button>
      </div>
    </div>
  </div>
</template>
