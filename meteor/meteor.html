<head>
  <title>BEAGLE</title>
</head>

<body>
  {{> loginButtons}}
</body>

<template name="sidebar">
  <div class="sidebar">
    <p>The source URL is: {{sourceUrl}}</p>
    <!-- <p>Its creator is: {{creator}}</p> -->
    <p><button class="screenshot-taker">Take a screenshot</button></p>
    {{#each highlights}}
      {{> highlight}}
    {{/each}}
  </div>
  {{#with linkPreview}}
    {{> linkPreviewer}}
  {{/with}}
  {{#with linkEdit}}
    {{> linkEditor}}
  {{/with}}
</template>

<template name="highlight">
  <div class="highlight {{#if hovered}}hovered{{/if}} {{#if clicked}}clicked{{/if}}" id="{{_id}}">
    <div class="sourceText">{{sourceText}}</div>
    {{#each annotations}}
      {{> annotation}}
    {{/each}}
  </div>
</template>

<template name="annotation">
  <div class="annotation">
    {{#if compose}}
      {{> composeBox}}
    {{else}}
      {{> singleAnnotation}}
    {{/if}}
    {{#if annotations}}
      <div class="replies">
        {{#each annotations}}
          {{> annotation}}
        {{/each}}
      </div>
    {{/if}}
  </div>
</template>

<template name="singleAnnotation">
  <div class="authorBlock">
    <img src="{{author.picture}}"/>
    <span class="author">{{author.name}}</span>
    <time datetime={{toISOString createdAt}} title={{localISO createdAt}}>{{fromNow createdAt}}</time>
    <div class="actionBar">
      {{#if owner}}
        <span class="edit">Edit</span>
      {{/if}}
      <span class="reply">Reply</span>
    </div>
  </div>
  <div class="annotation">
    <div class="content">{{{content}}}</div>
  </div>
</template>

<template name="composeBox">
  <div class="composeBox">

    <div class="toolbar">
      <button data-command="bold"><b>B</b></button>
      <button data-command="italic"><i>I</i></button>
      <button data-command="underline"><u>U</u></button>
      <button data-command="strikeThrough"><strike>S</strike></button>
      <button data-command="insertUnorderedList">•</button>
      <button data-command="insertOrderedList">1.</button>
      <button data-command="indent">&gt;</button>
      <button data-command="outdent">&lt;</button>
      <button class="removeFormat"><i>T</i><sub><small>X</small></sub></button>
      <button class="createLink"><a href="#">K</a></button>
    </div>

    <div class="composeFieldContainer">
      <div contenteditable class="composeField"></div>
    </div>

    <button class="save">Save</button>
    <button class="discard">Discard</button>
    {{#if editing.content}}
      <button class="delete">Delete</button>
    {{/if}}

  </div>
</template>

<template name="linkPreviewer">
  <div class="linkPreviewContainer" style="top: {{y}}px">
    <div id="linkPreviewer">
      <a class="change" href="#">Change</a>
      <a class="remove" href="#">Remove</a>
      <span class="gotoLink"><span class="goto">Go to:</span> <a target="_blank" href="{{href}}">{{href}}</a></span>
    </div>
  </div>
</template>

<template name="linkEditor">
  <div class="linkEditContainer" style="top: {{y}}px">
    <div id="linkEditor">
      <form>
        <div>
          <label for="displayText">Text:</label>
          <input name="displayText" type="text" value="{{text}}" required tabindex=1>
        </div>
        <div>
          <label for="href">Link to:</label>
          <input name="href" type="text" value="{{href}}" required pattern="(mailto:)?^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?)*|(https?://)?[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?)+(\/.*)?" tabindex=2>
        </div>
      </form>
      <div>
        <button class="discard" formnovalidate tabindex=4>Discard</button>
        <button class="done" tabindex=3>Done</button>
      </div>
    </div>
  </div>
</template>
